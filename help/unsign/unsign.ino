#include <TweetNaCl2.h>

TweetNaCl2 tuit;

byte alicepk[crypto_sign_PUBLICKEYBYTES]
={  0xb6,0xa6,0x83,0x9a,0x41,0x03,0x25,0xb1
   ,0xc8,0x04,0x33,0xc1,0x19,0x50,0xdd,0x26
   ,0x96,0x62,0xb1,0x67,0xe9,0x0b,0xa5,0x46
   ,0xe7,0x48,0x5f,0xa9,0x15,0x10,0x2e,0x51 };


byte sm[64+41]
= {0x13 ,0xA7 ,0x1B ,0xC6 ,0x8 ,0x1 ,0xD4 ,0xDB
 ,0x13 ,0xB ,0x33 ,0x38 ,0x3F ,0xF2 ,0xDE ,0xCD
 ,0xD4 ,0xC4 ,0xDD ,0xAA ,0x59 ,0x8C ,0xDC ,0x6F
 ,0x76 ,0x3B ,0x78 ,0xDB ,0xAE ,0x94 ,0x11 ,0x23
 ,0x31 ,0x6F ,0x9E ,0xA2 ,0x4 ,0xFC ,0x54 ,0x5B
 ,0xBC ,0xBD ,0x3B ,0x85 ,0xB4 ,0x32 ,0xBB ,0xC3
 ,0x54 ,0x66 ,0xE0 ,0xCD ,0x2F ,0xE7 ,0xDC ,0x11
 ,0x12 ,0x1C ,0xFC ,0xAE ,0x54 ,0xEE ,0xC4 ,0x8
 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0
 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0
 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0
 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0 ,0x0
 ,0xDE ,0x61 ,0x18 ,0xC ,0x6F ,0x72 ,0xB9 ,0x66
 ,0x2A };

unsigned long long smlen = 64+41;
unsigned char m[41];
unsigned long long mlen;

void setup() {
  Serial.begin(9600);
  Serial.println("start");
  int Suc_Unsign = 20;
  Suc_Unsign = tuit.crypto_sign_open(m,&mlen,sm,smlen,alicepk);
  Serial.println(Suc_Unsign);
  int i;
   for(i=0;i<mlen;i++){
       Serial.print(" ,0x");
       Serial.print(m[i],HEX);
       if(i%8==7){
         Serial.println();
       }
     } 
}

void loop() {
  // put your main code here, to run repeatedly:

}
